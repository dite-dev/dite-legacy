import { createServer } from '{{{ serverPath }}}';
import { readConfig } from '@dite/core/config';

global.__dite_server_start_time = performance.now();

const config = readConfig('/Users/heixing/Git/dite/examples/boilerplate');

global.__dite_config = config;

(async () => {
  config.port = process.env.PORT || config.port;
  await createServer({ config });
  const payload = {
    type: 'dite:ready',
    port: config.port,
    finishTime: Math.ceil(performance.now()),
  };
  process.send?.(payload);
})();
